function nslookupPage(d,l){"use strict";const u=document.getElementById(d.button),y=document.getElementById(d.domainField),L=document.getElementById(d.serverSelector),w=document.getElementById(d.recTypeSelector),k=document.getElementById(d.resultElement);let I=function(e){(e.key==="Enter"||e.keyCode===13)&&u.click()};y.addEventListener("keydown",I),L.addEventListener("change",function(){u.click()}),w.addEventListener("change",function(){u.click()}),u.addEventListener("click",function(e){M({btn:u,srv:L,types:w,df:y,res:k})}),y.focus();function M(e){const r='<div class="doh-data-row">TTL {TTL} s, {value}</div>',h=e.btn,g=e.srv,F=e.types,T=e.res;let c=e.df.value,b=F.options[F.selectedIndex].value,A=g.options[g.selectedIndex].dataset.url.replace("{domain}",c).replace("{type}",b),S=function(t){return t?`<div>Name: ${t}</div>`:""},m="",p="";if(c===""){T.innerHTML=s(l.msgEmptyString,"warning");return}if(x(c)||(H(c)?(m=N(c),m!==null?A=g.options[g.selectedIndex].dataset.url.replace("{domain}",m).replace("{type}",b):p=l.msgPunicode.replace("{domain}",E(c))):p=l.msgNotValid.replace("{domain}",E(c))),p!==""){T.innerHTML=s(p,"warning");return}h.disabled=!0,fetch(A,{method:"GET",headers:{Accept:"application/dns-json"}}).then(t=>t.json()).then(t=>{let i="",$=/^(\d+)\s+(.+)/;if(h.disabled=!1,!t||typeof t.Status>"u")i=s(l.msgUnexpected,"warning");else if(t.Status===3)i=s(l.msgNotExists.replace("{domain}",c),"warning");else if(t.Status===0&&typeof t.Answer<"u"&&t.Answer.length>0){let f=t.Answer,o=[];for(let n=0;n<f.length;n++){let a=E(f[n].data);if(f[n].type===15){const v=$.exec(a);v&&(a="Priority "+v[1]+", "+v[2],o.push({num:parseInt(v[1]),TTL:f[n].TTL,value:a}))}else i+=r.replace("{TTL}",f[n].TTL).replace("{value}",a)}o.sort((n,a)=>n.num-a.num);for(let n=0;n<o.length;n++)i+=r.replace("{TTL}",o[n].TTL).replace("{value}",n===0?`<b>${o[n].value}</b>`:o[n].value)}else i=s(l.msgNoRecord,"warning");T.innerHTML=S(m)+i}).catch(t=>{h.disabled=!1,T.innerHTML=S(m)+s(l.msgAnError,"error")})}function E(e){const r=document.createElement("div");return r.innerText=e,r.innerHTML}function x(e){return/^(?!.*\.\.)(?!-)([_A-Za-z0-9-]{1,63}(?<!-)\.)+[A-Za-z]{2,63}$/.test(e)}function H(e){return/^(?!.*\.\.)(?!-)([a-zA-Z0-9\u0080-\uFFFF-]{1,63}(?<!-)\.)+[a-zA-Z\u0080-\uFFFF]{2,63}$/.test(e)&&/[^\x00-\x7F]/.test(e)}function N(e){try{return new URL(`http://${e}`).hostname}catch{return null}}function s(e,r){return`<div class="page-message page-message--${r}">${e}</div>`}}
