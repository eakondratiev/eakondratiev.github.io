<!doctype html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Whitespace and UTF Characters</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="apple-mobile-web-app-title" content="Whitespace and UTF Characters" />
    <meta name="application-name" content="Whitespace and UTF Characters" />
    <meta name="msapplication-config" content="/assets/icons/browserconfig.xml" />
    <meta name="theme-color" content="#ffffff" />
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-touch-icon-180.png" />
    <link rel="manifest" href="/assets/icons/manifest.json" />
    <link rel="icon" type="image/png" href="/assets/icons/favicon-32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/assets/icons/favicon-16.png" sizes="16x16" />
  
    <link href="/assets/main.css?201920" rel="stylesheet" type="text/css" />
    <script src="/assets/menu.js"></script>
    <style>
      .dim-text {color:#555;}
      #text-box, #text-processed {
        border: solid 1px #999;
        box-sizing: border-box; padding:4pt; width:100%;}
      #text-box {font-size:1rem;}
      #text-processed {font-family:"SFMono-Regular",Consolas,"Liberation Mono",Menlo,Courier,monospace;
        display:none; margin: 16pt 0; width:100%;}
      #text-processed b {color: #c00; min-width:2pt; background: #fd9;} /* non-ascii */
      #text-processed i {background: #eee; font-style: normal; color: #777;} /* whitespace */
      .new-line-symbol {font-family: 'Lucida Console'; font-size:0.8rem; padding: 0 2pt;}
    </style>
  </head>
  <body>
    <div class="main-content">
      <div class="page-wide header">
        <header class="content">
          <div class="site-menu-btn">
            <div></div>
            <div></div>
            <div></div>
          </div>
          <div class="site-title"><a class="site-logo" href="/">TOOL</a></div>
        </header>
        <nav class="content site-nav">
          <ul>
          <li class="site-nav-top-item"><a href="/">Home Page</a></li>
          <li class="site-nav-top-item"><a href="iprange.htm">IPv4 Ranges</a></li>
          <li class="site-nav-top-item"><a href="speed.htm">Speed &amp; Distance</a></li>
          </ul>
        </nav>
      </div>
      <div class="page-wide">
        <div class="content">
          <h1>Whitespaces and UTF</h1>

          <p class="dim-text">Highlights whitespaces and UTF characters in the text.</p>
          <p>Enter or paste a text here...</p>
          <textarea id="text-box" rows="5"></textarea>
          <div>Text length: <b id="text-len"></b></div>
          <div id="text-processed"></div>
        </div>
      </div>
    </div>
    <div class="page-wide footer">
      Web tools.
    </div>
    <script>
      (function () {

        const URL_PARAM = "q";

        var sourceElement = document.getElementById("text-box"),
          targetElement = document.getElementById("text-processed"),
          lenElement = document.getElementById("text-len"),
          textParamRaw = GetUrlText();

        sourceElement.focus();
        sourceElement.onchange = textChanged;
        sourceElement.onkeyup = textChanged;

        if (textParamRaw) {
          sourceElement.value = decodeURIComponent(textParamRaw);
          textChanged();
        }

        function textChanged() {

          targetElement.innerHTML = processText(sourceElement.value);
          targetElement.style.display = "block";
          lenElement.innerHTML = sourceElement.value.length.toString();

          window.history.pushState('ws.htm', 'Title', '/ws.htm?' +
            URL_PARAM + '=' + encodeURIComponent(sourceElement.value));
        }

        function processText(source) {

          // NOTE: textarea internal value, the line breaks are normalized to LF (only).
          var reNonAscii = /([\u00FF-\uFFFF])/g,
            reNewline = /\n/g,
            reWhiteSpace = /[ ]/g,
            reTab = /\t/g;
          return source.replace(reNonAscii, '<b>$1</b>')
            .replace(reTab, '<i>&rarr;</i>')
            .replace(reWhiteSpace, '<i>.</i>')
            .replace(reNewline, '<i class="new-line-symbol">&para;</i><br />');
        }

        /**
         * Returns the text from url parameter or null.
         * */
        function GetUrlText() {

          try {
            var url = new URL(window.location.href);
            return url.searchParams.get(URL_PARAM);
          }
          catch (error) {
            return null;
          }

        }
      })();
    </script>
  </body>
</html>